\documentclass[a4paper,12pt]{article}
\usepackage{amsmath, amssymb}

\usepackage[utf8]{inputenc}
%\usepackage[spanish]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{exercise}

\author{Pilar Barbero Iriarte}

\newenvironment{exercise}[1]% environment name
{% begin code
  \par\vspace{\baselineskip}\noindent
  \textbf{Ejercicio (#1)}\begin{itshape}%
  \par\vspace{\baselineskip}\noindent\ignorespaces
}%
{% end code
  \end{itshape}\ignorespacesafterend
}


\begin{document}

\begin{titlepage}
\begin{center}


% Upper part of the page. The '~' is needed because \\
% only works if a paragraph has started.

\textsc{\LARGE M\'aster en Modelizaci\'on \\e Investigaci\'on Matem\'atica,\\ Estad\'istica y Computaci\'on }\\[1.5cm]
{\large \today}

\textsc{Ejercicios Tercera Parte}\\[0.5cm]

% Title
\vfill

{ \huge \bfseries Modelos de Log\'istica \\[0.4cm] }

\vfill


\includegraphics[width=0.5\textwidth]{../logoUZ.png}~\\[1cm]

% Author and supervisor
\noindent
\begin{minipage}{0.4\textwidth}
\begin{flushleft} \large
\emph{Autor:}\\
Pilar Barbero Iriarte 
\end{flushleft}
\end{minipage}%
\begin{minipage}{0.4\textwidth}
\begin{flushright} \large
\emph{Profesor:} \\
Javier L\'opez Lorente
\end{flushright}
\end{minipage}

% Bottom of the page
\end{center}


\end{titlepage}

\pagebreak
\tableofcontents
\pagebreak

\section{Ejercicio}
\begin{exercise}{1}
Tenemos que gestionar el aprovisionamiento de un producto para el que tenemos un sistema de revisión continuo. La demanda del producto es continua (es decir, no llegan grandes pedidos de una vez) y estacionaria a lo largo del tiempo; disponemos de datos de las últimas 40 semanas que se adjuntan en el fichero demanda1.xls. El lead-time no es fijo, pero disponemos de datos de los tiempos de entrega, en días, de los últimos 30 pedidos (se adjuntan en el fichero). Los costes del proceso son: coste por hacer un pedido 400 euros; coste por unidad 10 euros, coste por almacenamiento 1.5 euros por unidad y semana.\\

En caso de ruptura del stock, las unidades retrasadas se dejan sin entregar y se estima un coste de 1000 euros cada vez que se rompe el stock. Se trabaja 6 días a la semana todas las semanas del año y en el lead-time no se tienen en cuenta los domingos (es decir, el lunes es el primer día después del sábado).\\

\begin{itemize}

\item[A.] Se quiere que no más del 2\% de las unidades se entreguen con retraso. Calcular la política de aprovisionamiento óptima (es decir, de menor costo) sujeta a la restricción de unidades no entregadas. ¿Cuál es el valor del stock de seguridad? ¿Cuál es la probabilidad de ruptura del stock en cada ciclo? Determina los costes anuales de almacenamiento, de pedido y de material. 

\item[B.] Si quitamos la restricción del apartado (A) de que no más del 2\% de las unidades se entreguen con retraso, calcula la política de aprovisionamiento óptima (es decir, de menor costo) ¿Cuál es el valor del stock de seguridad? ¿Cuál es la probabilidad de ruptura del stock en cada ciclo? Determina los costes anuales de almacenamiento, de pedido y de material.

\item[C.] Supongamos ahora que el precio de las unidades tiene un descuento, de manera que las primeras 300 unidades se pagan a 10 euros, las siguientes hasta 500 se pagan a 9 euros y las siguientes a partir de 500 a 8 euros. Responde a las preguntas del apartado (A) en esta nueva situación.
\end{itemize}

\end{exercise}

El beneficio vendr\'a dado por:

$$ B(q,x) = \text{ si }$$

	\begin{equation*}
	B(q,x) = \left\lbrace \begin{array}{l}
		sx + v(q - x) - a - cq \text{ si } x\leq q \\
		sq - p(x - q) - a - cq \text{ si } x > q
	\end{array}
	\right. 
	\end{equation*}
	
\begin{itemize}

\item[] \textbf{Lead-time medio:} $6,9655172414$
\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\\
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\\


Vamos a definir nuestra demanda como una variable aleatoria $D$ cuya esperanza y desviaci\'on t\'ipica se define a partir de los datos suministrados.

\begin{itemize}
\item[] \textbf{$\mu_D$} $= 97.6$
\item[] \textbf{$\sigma_D^2$} $= 233.502827088$
\end{itemize}

En nuestro caso, el lead-time tambi\'en es aleatorio, pero contamos con algunos datos anteriores, as\'i que tambi\'en podemos calcular su media y su varianza,

\begin{itemize}
\item[] \textbf{$\mu_L$} $= 6.73333333333$
\item[] \textbf{$\sigma_L^2$} $= 1.92888888889$
\end{itemize}



Queremos estudiar la demanda de $X$ que vamos a tener para $L$ unidades de tiempo marcadas por el lead-time, por lo que,

$$\mu_X = \mu_L \mu_D \text{ y } \sigma_X^2 = \mu_L \sigma_D^2 + \sigma_L^2 \mu_D^2$$

As\'i la demanda por unidades de tiempo queda de la siguiente manera,


	\begin{equation*}
	X:  \left\lbrace \begin{array}{l}
		\mu_X = \mu_L \mu_D = 45.337777777777781\\
		\sigma_X^2 = \mu_L \mu_D^2 + \sigma_L^2 \mu_D^2 = 25.975703703703704
	\end{array}
	\right. 
	\end{equation*}

Vamos a modelizar nuestro problema utilizando un modelo de revisi\'on continua, dado que podemos controlar el stock y realizar los pedidos cuando queramos. La pol\'itica con la que se trabaja es la $(r, q)$. Se fija un punto $r$ punto de pedido y cuando el inventario llegue a ese punto, se pide una cantidad fija $q$. \\

Vamos a estudiar \textbf{la probabilidad de ruptura del stock}. El \'unico momento en el que se puede producir la posibilidad de ruptura del stock es durante el lead-time. Cuando veamos que el stock baja de una cantidad $r$, haremos el siguiente pedido, pero puede ser que la demanda durante el lead-time sea mayor que $r$, en cuyo caso no podremos satisfacerla. Por esta raz\'on, contamos con nuestra variable $X$, demanda durante el lead-time. Estimaremos que nuestra variable $X$ se comporta como una variable normal de media y desviaci\'on t\'ipica conocidas gracias a los c\'alculos anteriores.\\

La cantidad media de demanda que esperamos durante el lead-time es $\mu_X$, si realizamos el pedido cuando tenemos un nivel de stock de $r$, en media esperamos tener un $r - \mu_X = r - 45.337777777777781$, es decir, nuestro \textit{stock de seguridad}. Podemos escribir el stock de seguridad como un factor de la desviaci\'on t\'ipica de X: $r - \mu_X = k\sigma_X = k \sqrt{\sigma_X^2} =  5.09663650889 k$. Si tomamos $k = 2$, esto presenta una probabilidad de ruptura mayor del 2\%, por lo que nuestro stock de seguridad quedar\'ia:

$$ \text{stock de seguridad} = 2 \cdot 5.1 = 10.2 \sim 10.2$$

Con respecto a la probabilidad de ruptura del stock, nuestra variable $X$ tiene una distribuci\'n $N(45.337777777777781, 5.09663650889) \sim N(45.34, 5.1)$,

\begin{equation*}
\begin{array}{l l}
 P(\text{ruptura del stock}) & =  P(X > r) = P\left(\dfrac{X - \mu_X}{\sigma_X} > \dfrac{r-\mu_X}{\sigma_X}\right) \\[0.5cm]
 \, &   = P\left(\dfrac{X - 45.34}{5.1} > k\right) = P\left(\dfrac{X - 45.34}{5.1} > 2\right) \\[0.5cm]
 \, &   = P(Z > 2) = 1 - P(Z \leq 2) = 1 - 0.9772 =  0.0228
\end{array}
\end{equation*}


As\'i $k = \dfrac{r - \mu_X}{\sigma_X} = \dfrac{r - 45.32}{5.1} = 2$

\pagebreak



\textbf{An\'alisis del coste:} 

\begin{itemize}
\item[] \textbf{Coste por pedido:} $a = 500$ euros.
\item[] \textbf{Coste por unidad:} $c = 10$ euros.
\item[] \textbf{Coste de almacenamiento por unidad y semana:} $h = 1.5$ euros.

\item[] \textbf{Coste por unidad no satisfecha:} $c_s = 0$
\end{itemize}

Para calcular de forma aproximada el coste de almacenamiento, notemos que si pedimos cuando nuestro nivel de almacenamiento llegue a $r$ y hasta que nos llega el pedido, esperamos una demanda de $\mu_X$, el valor m\'inimo de nuestro stock es $r - \mu_X$ y el m\'aximo es de $r - \mu_X + q$ con $q$ la cantidad fija que pedimos cuando llegamos al punto $r$ de stock. \\

El valor medio del stock ser\'a de $r - \mu_X + \frac{q}{2} = k\sigma_X + \frac{q}{2} = 2\cdot 5.1 + \frac{q}{2} $

Esto es un valor aproximado, ya que en realidad al m\'aximo stock habr\'ia que restarlo las unidades no satisfechas a tiempo del ciclo anterior. \\


El coste de almacenamiento por ciclo ser\'a, en media, $k \sigma_X + \frac{q}{2}$ multiplicado por la longitud de nuestro ciclo, la cual es  
$\frac{q}{\mu_D}$ y multiplicado por nuestro coste de almacenamiento $h$. Por otro lado, en cada ciclo esperamos $\sigma_X G(k)$ unidades de demanda no satisfechas a tiempo.

El coste por ciclo ser\'a,

$$ \frac{coste}{ciclo} = a + qc + (k \sigma_X  + \frac{q}{2})\frac{qh}{\mu_D} + c_s\sigma_XG(k)$$

El coste por unidad de tiempo ser\'a,

$$ \text{coste} = \frac{a\mu_D}{q} + \mu_D c + (k\sigma_X + \frac{q}{2}) h + \frac{c_s\sigma_X \mu_D G(k)}{1.5}$$

$q$ vendr\'a dado por,

$$ q = \sqrt{\frac{2\mu_D (a + c_s \sigma_X G(k))}{h}} = \sqrt{\frac{2\cdot 45.32(500 + c_s\sigma_X G(k))}{h}}$$
     

\end{document}